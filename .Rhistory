##                             13- create_token()                             ##
##----------------------------------------------------------------------------##
token <- create_token(app_name, consumer_key, consumer_secret)
token
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
## refresh .Renviron variables
readRenviron("~/.Renviron")
## get status IDs of jack's friend's
fds <- get_friends("jack")
View(fds)
## get friends of multiple accounts
fds <- get_friends(c("hadleywickham", "NateSilver538", "Nate_Cohn"))
fds
View(fds)
## get mike's followers
kmw <- get_followers("kearneymw")
kmw
View(kmw)
## get all of trump's followers
rdt <- get_followers("realdonaldtrump", n = 5e7, retryonratelimit = TRUE)
## get all of trump's followers
rdt <- get_followers("AOC", n = 5e7, retryonratelimit = TRUE)
View(fds)
View(kmw)
## get my followers
my_followers <- get_followers(reportercioffi,n = 75000,page = "-1",retryonratelimit = FALSE,parse = TRUE,verbose = TRUE,token = NULL)
## get my followers
my_followers <- get_followers("reportercioffi",n = 75000,page = "-1",retryonratelimit = FALSE,parse = TRUE,verbose = TRUE,token = NULL)
View(my_followers)
## get my followers
my_followers <- get_followers("reportercioffi",n = 75000)
## get my followers
my_followers <- get_followers("reportercioffi")
## get mike's followers
kmw <- get_followers("reportercioffi")
## get mike's followers
kmw <- get_followers("AOC")
kmw <- get_followers("kearneymw")
kmw <- get_followers("kearneymw")
fds <- get_friends(c("hadleywickham", "NateSilver538", "Nate_Cohn"))
fds
app_name <- "cjc_twitter_app"
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
#Log your info with the Twitter API:
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
## refresh .Renviron variables
readRenviron("~/.Renviron")
## get status IDs of jack's friend's
fds <- get_friends("jack")
View(fds)
## get status IDs of jack's friend's
fds <- as_screenname(get_friends("jack"))
## get status IDs of jack's friend's
fds <- get_friends("jack", as_screenname(x))
## get status IDs of jack's friend's
fds <- get_friends(as_screenname("jack"))
## get status IDs of jack's friend's
fds <- get_friends("jack")
View(fds)
get_friends(as_screenname("jack"))
help <- get_friends(as_screenname("jack"))
test <- as_screenname(fds)
test <- as_screenname(fds$user_id)
test <- data.frame(as_screenname(fds$user_id))
test
as_screenname("188055923")
as_screenname("188055923")
as_userid("188055923")
fds <- get_friends("jack")
View(fds)
## get status IDs of jack's friend's
fds <- get_friends("jack", screen_name)
View(fds)
as_screenname(fds)
as_screenname(x)
## get status IDs of jack's friend's
as_screenname(fds) <- get_friends("jack")
as_screenname(get_friends("jack"))
help(as_screenname)
get_friends(as_screenname("1234"))
app_name <- "cjc_twitter_app"
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
#Log your info with the Twitter API:
token <- create_token(app_name, consumer_key, consumer_secret)
token
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
## refresh .Renviron variables
readRenviron("~/.Renviron")
get_friends(as_screenname("1234"))
## get status IDs of jack's friend's
fds <- get_friends("jack")
View(fds)
get_friends(as_screenname("1234"))
st <- get_friends(as_screenname("1234"))
st <- get_friends(as_screenname("jack"))
library(rtweet)
library(tidyverse)
library(twitteR)
#Thanks to SARA WISE for the renvirontrick to store api keys
#access api info from: open your preferred terminal app, type in nano ~/.Renviron  then paste in these two lines
#those ^ are your keys, as pushed to git. after that, press ctrl+X to exit and then Y to save the file as modified.
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
access_token <- Sys.getenv("TWITTER_ACCESS_TOKEN")
access_secret <- Sys.getenv("TWITTER_ACCESS_SECRET")
options(httr_oauth_cache=T) #This will enable the use of a local file to cache OAuth access credentials between R sessions.
setup_twitter_oauth(consumer_key,
consumer_secret,
access_token,
access_secret)
#######
reportercioffi <- getUser("reportercioffi")
AOC <- getUser("AOC")
#See this user's location:
AOC$location
AOC
length(cioffi_follower_IDs)
cioffi_follower_ids<-reportercioffi$getFollowers(retryOnRateLimit=180)
kmw <- get_followers("kearneymw")
app_name <- "cjc_twitter_app"
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
#Log your info with the Twitter API:
##----------------------------------------------------------------------------##
##                             13- create_token()                             ##
##----------------------------------------------------------------------------##
token <- create_token(app_name, consumer_key, consumer_secret)
token
##----------------------------------------------------------------------------##
##                               14- save token                               ##
##----------------------------------------------------------------------------##
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
##----------------------------------------------------------------------------##
##                            15- refresh .Renviron                           ##
##----------------------------------------------------------------------------##
## refresh .Renviron variables
readRenviron("~/.Renviron")
## get status IDs of jack's friend's
fds <- get_friends("jack")
as_screenname(get_friends("jack"))
fds <- get_friends("jack")
app_name <- "cjc_twitter_app"
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
#Log your info with the Twitter API:
token <- create_token(app_name, consumer_key, consumer_secret)
token
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
## refresh .Renviron variables
readRenviron("~/.Renviron")
fds <- get_friends("jack")
library(tidyverse)
library(twitteR)
#Thanks to SARA WISE for the renvirontrick to store api keys
#access api info from: open your preferred terminal app, type in nano ~/.Renviron  then paste in these two lines
#those ^ are your keys, as pushed to git. after that, press ctrl+X to exit and then Y to save the file as modified.
consumer_key <- Sys.getenv("TWITTER_CONSUMER_KEY")
consumer_secret <- Sys.getenv("TWITTER_CONSUMER_SECRET")
access_token <- Sys.getenv("TWITTER_ACCESS_TOKEN")
access_secret <- Sys.getenv("TWITTER_ACCESS_SECRET")
#Log your info with the Twitter API:
options(httr_oauth_cache=T) #This will enable the use of a local file to cache OAuth access credentials between R sessions.
setup_twitter_oauth(consumer_key,
consumer_secret,
access_token,
access_secret)
#######
#https://www.rdocumentation.org/packages/rtweet/versions/0.6.9
# Step 2: Download the Followers of a Given Twitter Account
#######
reportercioffi <- getUser("reportercioffi")
AOC <- getUser("AOC")
#See this user's location:
AOC$location
app_name <- "CJC_rtweet"
consumer_key <- Sys.getenv("RTWEET_CONSUMER_KEY")
consumer_secret <- Sys.getenv("RTWEET_CONSUMER_SECRET")
#Log your info with the Twitter API:
##----------------------------------------------------------------------------##
##                             13- create_token()                             ##
##----------------------------------------------------------------------------##
token <- create_token(app_name, consumer_key, consumer_secret)
token
##----------------------------------------------------------------------------##
##                               14- save token                               ##
##----------------------------------------------------------------------------##
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
##----------------------------------------------------------------------------##
##                            15- refresh .Renviron                           ##
##----------------------------------------------------------------------------##
## refresh .Renviron variables
readRenviron("~/.Renviron")
token <- create_token(app_name, consumer_key, consumer_secret)
token
token <- create_token(app_name, consumer_key, consumer_secret)
library(tidyverse)
library(rtweet)
token <- create_token(app_name, consumer_key, consumer_secret)
token
##----------------------------------------------------------------------------##
##                               14- save token                               ##
##----------------------------------------------------------------------------##
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
##----------------------------------------------------------------------------##
##                            15- refresh .Renviron                           ##
##----------------------------------------------------------------------------##
## refresh .Renviron variables
readRenviron("~/.Renviron")
fds <- get_friends("jack")
#VIA newsnerds Caitlin Gilbert (tx!)
followers <- get_followers("reportercioffi", n=1000, page = "-1")
View(followers)
#VIA newsnerds Caitlin Gilbert (tx!)
followers <- get_followers("reportercioffi", page = "-1")
View(followers)
#VIA newsnerds Caitlin Gilbert (tx!)
followers <- get_followers("reportercioffi")
View(followers)
follower_IDs <- dplyr::pull(followers, user_id)
followers_allinfo <- lookup_users(follower_IDs)
View(followers_allinfo)
followers <- get_followers("AOC")
follower_IDs <- dplyr::pull(followers, user_id)
followers_allinfo <- lookup_users(follower_IDs)
followers <- get_followers("AOC")
View(followers_allinfo)
View(followers)
lookup_many_users <- function(followers$user_id, twitter_token, retry_limit = 5){
require(rtweet)
lookup_many_users <- function(followers, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(dataset$user_id), 89999)
if(breaks[length(breaks)] != length(dataset$user_id)){
breaks <- c(breaks, length(dataset$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(dataset$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
breaks <- seq(1, length(dataset$user_id), 89999)
if(breaks[length(breaks)] != length(dataset$user_id)){
breaks <- c(breaks, length(dataset$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(dataset$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
}
lookup_many_users <- function(followers, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(dataset$user_id), 89999)
if(breaks[length(breaks)] != length(dataset$user_id)){
breaks <- c(breaks, length(dataset$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(dataset$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
}
lookup_many_users()
lookup_many_users <- function(followers, twitter_token, retry_limit = 5){
require(rtweet)
lookup_many_users <- function(followers$user_id, twitter_token, retry_limit = 5){
require(rtweet)
lookup_many_users <- function(followers$user_id, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(dataset$user_id), 89999)
if(breaks[length(breaks)] != length(dataset$user_id)){
breaks <- c(breaks, length(dataset$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(dataset$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
}
View(lookup_many_users)
run(lookup_many_users)
lookup_many_users <- function(followers$user_id, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(followers$user_id), 89999)
if(breaks[length(breaks)] != length(followers$user_id)){
breaks <- c(breaks, length(followers$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(followers$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
lookup_many_users <- function(followers$user_id, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(followers$user_id), 89999)
if(breaks[length(breaks)] != length(followers$user_id)){
breaks <- c(breaks, length(followers$user_id))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(followers$user_id[breaks[i]:breaks[i+1]])
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
}
lookup_many_users <- function(users, twitter_token, retry_limit = 5){
require(rtweet)
breaks <- seq(1, length(users), 89999)
if(breaks[length(breaks)] != length(users)){
breaks <- c(breaks, length(users))
}
user_details <- NULL
for(i in 1:(length(breaks) -1)){
attempt <- 0
while(is.null(user_details) && attempt <= retry_limit){
attempt <- attempt + 1
try({
user_details <- lookup_users(users[breaks[i]:breaks[i+1]], token = twitter_token)
Sys.sleep(15 * 60) #wait 15 minutes for rate limit to reset before proceeding
})
}
if(is.null(user_details)){
stop("failed to get users")
}
if(i == 1){
all_user_details <- user_details
} else {
all_user_details <- rbind(all_user_details, user_details)
}
user_details <- NULL
}
return(all_user_details)
}
return(all_user_details)
}
library(tidyverse)
library(rtweet)
#using https://github.com/mkearney/nicar_tworkshop/blob/master/script.R to do some new exploring
#Thanks to SARA WISE for the renvirontrick to store api keys
#access api info from: open your preferred terminal app, type in nano ~/.Renviron  then paste in these two lines
#those ^ are your keys, as pushed to git. after that, press ctrl+X to exit and then Y to save the file as modified.
app_name <- "CJC_rtweet"
consumer_key <- Sys.getenv("RTWEET_CONSUMER_KEY")
consumer_secret <- Sys.getenv("RTWEET_CONSUMER_SECRET")
#Log your info with the Twitter API:
##----------------------------------------------------------------------------##
##                             13- create_token()                             ##
##----------------------------------------------------------------------------##
token <- create_token(app_name, consumer_key, consumer_secret)
token
## save token to home directory
path_to_token <- file.path(path.expand("~"), ".twitter_token.rds")
saveRDS(token, path_to_token)
## create env variable TWITTER_PAT (with path to saved token)
env_var <- paste0("TWITTER_PAT=", path_to_token)
## save as .Renviron file (or append if the file already exists)
cat(env_var, file = file.path(path.expand("~"), ".Renviron"),
fill = TRUE, append = TRUE)
## refresh .Renviron variables
readRenviron("~/.Renviron")
fds <- get_friends("AOC")
View(fds)
## get friends of multiple accounts
fds <- get_friends(c("AOC", "reportercioffi"))
View(fds)
View(followers_allinfo)
